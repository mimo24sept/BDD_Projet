<!DOCTYPE html>
<!--
  Fichier: index.html.
  Page d'auth unique pour centraliser login + inscription.
  Conserve le ripple ici pour un feedback visuel a la connexion.
  Charge base/auth pour separer styles communs et styles auth.
-->
<html lang="fr">
<head>
  <!-- Charset UTF-8 pour garder les libelles lisibles. -->
  <meta charset="UTF-8" />
  <!-- Viewport pour un rendu correct sur mobile. -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Connexion - Parc materiels</title>
  <script>
    // Force ?i=1 to avoid Infinityfree 404 when missing.
    (function ensureQueryFlag() {
      const url = new URL(window.location.href);
      const flag = url.searchParams.get('i');
      if (flag === null || flag === '') {
        url.searchParams.set('i', '1');
        window.location.replace(url.toString());
      }
    })();
  </script>
  <!-- Favicon pour l'identite visuelle dans l'onglet. -->
  <link rel="icon" type="image/svg+xml" href="./assets/favicon.svg" />
  <!-- Preconnect pour accelerer le chargement de la police. -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <!-- Police Manrope pour un rendu coherent avec l'app. -->
  <link href="https://fonts.googleapis.com/css2?family=Archivo+Black&family=Manrope:wght@400;600;700;800&display=swap" rel="stylesheet" />
  <!-- Base.css pour les styles partages. -->
  <link rel="stylesheet" href="./assets/styles/base.css" />
  <!-- Auth.css pour la page de connexion. -->
  <link rel="stylesheet" href="./assets/styles/auth.css" />
</head>
<body>
  <!-- Overlay ripple pour masquer la transition apres login. -->
  <div class="ripple-overlay" id="ripple-overlay">
    <div class="ripple-circle ripple-a"></div>
    <div class="ripple-circle ripple-b"></div>
    <div class="ripple-circle ripple-c"></div>
  </div>
  <!-- Conteneur plein ecran pour centrer la carte. -->
  <div class="auth-wall">
    <div class="panel auth-card">
      <!-- Branding pour garder le contexte. -->
      <div class="brand auth-brand">
        <div class="brand-mark">GE</div>
        <div>
          <h1>Parc Materiels GEII</h1>
        </div>
      </div>
      <div class="auth-forms">
        <!-- Bloc login visible par defaut. -->
        <div class="auth-form-block" id="login-block">
          <div class="small-title auth-form-title">Connexion</div>
          <form id="login-form" class="grid form-grid form-grid-end">
            <div class="input-group">
              <input id="login" name="login" placeholder="Login" aria-label="Login" required />
            </div>
            <div class="input-group password-field">
              <!-- Champ password avec bouton oeil pour verifier la saisie. -->
              <input id="password" name="password" type="password" placeholder="Mot de passe" aria-label="Mot de passe" required />
              <button type="button" class="password-toggle" aria-label="Afficher le mot de passe">
                <svg class="icon-eye" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
                  <path d="M2.458 12C3.732 7.943 7.523 5 12 5c4.477 0 8.268 2.943 9.542 7-1.274 4.057-5.065 7-9.542 7-4.477 0-8.268-2.943-9.542-7Z" />
                  <path d="M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z" />
                </svg>
                <svg class="icon-eye-off" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
                  <path d="M9.88 9.88a3 3 0 0 1 4.24 4.24" />
                  <path d="M7.06 7.06a8.96 8.96 0 0 0-4.602 4.94c1.274 4.057 5.065 7 9.542 7 1.843 0 3.577-.47 5.086-1.3" />
                  <path d="M14.121 14.121A3 3 0 0 1 9.88 9.88" />
                  <path d="M12 5c4.477 0 8.268 2.943 9.542 7a9.77 9.77 0 0 1-2.47 3.78" />
                  <path d="m4.52 4.52 14.96 14.96" />
                </svg>
              </button>
            </div>
            <button type="submit">Connexion</button>
            <div id="login-msg" class="message"></div>
            <button type="button" class="ghost" id="toggle-register">Créer un compte</button>
          </form>
        </div>

        <!-- Bloc inscription avec champ secret selon le role. -->
        <div class="auth-form-block" id="register-block" hidden>
          <div class="small-title auth-form-title">Créer un compte</div>
          <form id="register-form" class="grid form-grid form-grid-end">
            <div class="input-group">
              <input id="reg-email" name="email" type="email" placeholder="Email" aria-label="Email" required />
            </div>
            <div class="input-group">
              <input id="reg-login" name="login" placeholder="Login" aria-label="Login" required />
            </div>
            <div class="input-group password-field">
              <input id="reg-pass" name="password" type="password" placeholder="Mot de passe" aria-label="Mot de passe" required />
              <button type="button" class="password-toggle" aria-label="Afficher le mot de passe">
                <svg class="icon-eye" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
                  <path d="M2.458 12C3.732 7.943 7.523 5 12 5c4.477 0 8.268 2.943 9.542 7-1.274 4.057-5.065 7-9.542 7-4.477 0-8.268-2.943-9.542-7Z" />
                  <path d="M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z" />
                </svg>
                <svg class="icon-eye-off" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
                  <path d="M9.88 9.88a3 3 0 0 1 4.24 4.24" />
                  <path d="M7.06 7.06a8.96 8.96 0 0 0-4.602 4.94c1.274 4.057 5.065 7 9.542 7 1.843 0 3.577-.47 5.086-1.3" />
                  <path d="M14.121 14.121A3 3 0 0 1 9.88 9.88" />
                  <path d="M12 5c4.477 0 8.268 2.943 9.542 7a9.77 9.77 0 0 1-2.47 3.78" />
                  <path d="m4.52 4.52 14.96 14.96" />
                </svg>
              </button>
            </div>
            <div class="input-group password-field">
              <!-- Confirmation mot de passe pour limiter les erreurs. -->
              <input id="reg-pass2" name="confirm" type="password" placeholder="Confirmer le mot de passe" aria-label="Confirmer le mot de passe" required />
              <button type="button" class="password-toggle" aria-label="Afficher le mot de passe">
                <svg class="icon-eye" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
                  <path d="M2.458 12C3.732 7.943 7.523 5 12 5c4.477 0 8.268 2.943 9.542 7-1.274 4.057-5.065 7-9.542 7-4.477 0-8.268-2.943-9.542-7Z" />
                  <path d="M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z" />
                </svg>
                <svg class="icon-eye-off" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
                  <path d="M9.88 9.88a3 3 0 0 1 4.24 4.24" />
                  <path d="M7.06 7.06a8.96 8.96 0 0 0-4.602 4.94c1.274 4.057 5.065 7 9.542 7 1.843 0 3.577-.47 5.086-1.3" />
                  <path d="M14.121 14.121A3 3 0 0 1 9.88 9.88" />
                  <path d="M12 5c4.477 0 8.268 2.943 9.542 7a9.77 9.77 0 0 1-2.47 3.78" />
                  <path d="m4.52 4.52 14.96 14.96" />
                </svg>
              </button>
            </div>
            <div class="input-group">
              <!-- Role pour adapter les droits cote app. -->
              <select id="reg-role" name="role" aria-label="Profil">
                <option value="eleve">Eleve</option>
                <option value="professeur">Professeur</option>
                <option value="technicien">Technicien</option>
                <option value="administrateur">Administrateur</option>
              </select>
            </div>
            <div class="input-group password-field" id="reg-secret-row" hidden>
              <!-- Mot secret reserve aux roles sensibles. -->
              <input id="reg-secret" name="secret" type="password" placeholder="Mot de passe secret" aria-label="Mot de passe secret" />
              <button type="button" class="password-toggle" aria-label="Afficher le mot de passe">
                <svg class="icon-eye" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
                  <path d="M2.458 12C3.732 7.943 7.523 5 12 5c4.477 0 8.268 2.943 9.542 7-1.274 4.057-5.065 7-9.542 7-4.477 0-8.268-2.943-9.542-7Z" />
                  <path d="M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z" />
                </svg>
                <svg class="icon-eye-off" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
                  <path d="M9.88 9.88a3 3 0 0 1 4.24 4.24" />
                  <path d="M7.06 7.06a8.96 8.96 0 0 0-4.602 4.94c1.274 4.057 5.065 7 9.542 7 1.843 0 3.577-.47 5.086-1.3" />
                  <path d="M14.121 14.121A3 3 0 0 1 9.88 9.88" />
                  <path d="M12 5c4.477 0 8.268 2.943 9.542 7a9.77 9.77 0 0 1-2.47 3.78" />
                  <path d="m4.52 4.52 14.96 14.96" />
                </svg>
              </button>
            </div>
            <button type="submit">Créer un compte</button>
            <div id="register-msg" class="message"></div>
            <button type="button" class="ghost" id="back-to-login">Retour connexion</button>
          </form>
        </div>
      </div>
    </div>
  </div>
  <!-- Login.js gere la logique auth + ripple. -->
  <script src="./assets/login.js" defer></script>
</body>
</html>
